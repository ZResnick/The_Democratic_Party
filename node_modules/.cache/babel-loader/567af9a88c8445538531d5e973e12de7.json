{"ast":null,"code":"var _jsxFileName = \"/Users/zacharyresnick/Desktop/The_Democratic_Party/the_democratic_party/src/components/mainPages/AllSongs.js\";\nimport React, { Component } from 'react';\nimport SingleSong from './SingleSong';\nimport { connect } from 'react-redux';\nimport Spotify from './Spotify';\nimport grooverPlaylist from './spotifyConfig';\nimport removeSong from '../../store/reducers/songReducer'; //connect certain compomnents with the firestore using the firestoreConnect and compose at the bottom of this file:\n\nimport { firestoreConnect } from 'react-redux-firebase';\nimport { compose } from 'redux'; //spotify web api\n\nimport SpotifyWebApi from 'spotify-web-api-js';\nvar spotifyApi = new SpotifyWebApi();\nexport class AllSongs extends Component {\n  constructor() {\n    super();\n    this.getCurrentlyPlaying.bind(this);\n  }\n\n  componentDidUpdate() {\n    if (this.props.tokens) {\n      let token = this.props.tokens[0].token;\n      spotifyApi.setAccessToken(token);\n      this.getCurrentlyPlaying(token);\n    }\n  } //I cant get the information from get spotifyApi.getMyCurrentPlayingTrack to appear on state which made me have to go throught he madness below....\n\n\n  getCurrentlyPlaying(token) {\n    spotifyApi.getMyCurrentPlayingTrack(null, (err, data) => {\n      let currentSong = data && data.item.name;\n      let currentProgress = data && data.progress_ms;\n      let songLength = data && data.item.duration_ms;\n      let timeToEnd = songLength - currentProgress - 5000;\n      setTimeout(async () => {\n        let songs = this.props.songs;\n        let pageSongs = songs && [...songs];\n        let orderedSongs = pageSongs && pageSongs.sort((a, b) => a.upvotes > b.upvotes ? -1 : 1);\n        let topSong = orderedSongs[0];\n        console.log(\"ADDING \".concat(topSong.title, \" by \").concat(topSong.artist, \" TO THE GROOVER PLAYLIST\"));\n        await spotifyApi.getPlaylist(grooverPlaylist, null, async (err, data) => {\n          const snapshot = data && data.snapshot_id;\n          let songs = data && data.tracks.items;\n          let currentPosition = songs && songs.findIndex(song => song.track.name === currentSong);\n          let indicesToDestroy = [];\n\n          if (songs && songs.length) {\n            for (let i = currentPosition + 1; i < songs.length; i++) {\n              indicesToDestroy.push(i);\n            }\n          } else {\n            indicesToDestroy.push(1);\n          }\n\n          await spotifyApi.removeTracksFromPlaylistInPositions(grooverPlaylist, indicesToDestroy, snapshot, (err, success) => {\n            if (err) {\n              console.log('err', err);\n            }\n          });\n          await spotifyApi.addTracksToPlaylist(grooverPlaylist, [topSong.uri], {\n            position: currentPosition + 1\n          }, (err, data) => {\n            if (err) {\n              console.log('err', err);\n            }\n          });\n        });\n      }, timeToEnd);\n    });\n  }\n\n  render() {\n    let _this$props = this.props,\n        songs = _this$props.songs,\n        tokens = _this$props.tokens;\n    let pageSongs = songs && [...songs];\n    let token = tokens && tokens[0];\n    let orderedSongs = pageSongs && pageSongs.sort((a, b) => a.upvotes > b.upvotes ? -1 : 1);\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 97\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      className: \"allSongs container\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 98\n      },\n      __self: this\n    }, React.createElement(\"h3\", {\n      className: \"center\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 99\n      },\n      __self: this\n    }, \"All Songs\"), React.createElement(\"table\", {\n      className: \"container songList\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 100\n      },\n      __self: this\n    }, React.createElement(\"tbody\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 101\n      },\n      __self: this\n    }, React.createElement(\"tr\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 102\n      },\n      __self: this\n    }, React.createElement(\"th\", {\n      className: \"tableHeaders\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 103\n      },\n      __self: this\n    }, \"Remove\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 104\n      },\n      __self: this\n    }, \"Title\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 105\n      },\n      __self: this\n    }, \"Artist\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 106\n      },\n      __self: this\n    }, \"Album\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 107\n      },\n      __self: this\n    }, \"Run Time\"), React.createElement(\"th\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 108\n      },\n      __self: this\n    }, \"Votes\")), songs && orderedSongs.map(song => {\n      return React.createElement(SingleSong, Object.assign({\n        key: song.id\n      }, song, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 112\n        },\n        __self: this\n      }));\n    })))), React.createElement(\"div\", {\n      className: \"player\",\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    }, token && React.createElement(Spotify, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 117\n      },\n      __self: this\n    })));\n  }\n\n} // mapState;\n\nconst mapStateToProps = state => {\n  return {\n    songs: state.firestore.ordered.Songs,\n    tokens: state.firestore.ordered.spotifyToken\n  };\n};\n\nconst mapDispatchToProps = dispatch => ({\n  removeSong: id => {\n    dispatch(removeSong(id));\n  }\n}); //use compose to connect connect and firestoreConnect together...\n\n\nexport default compose(connect(mapStateToProps, mapDispatchToProps), firestoreConnect([{\n  collection: 'Songs',\n  orderBy: [['upvotes', 'desc']]\n}, {\n  collection: 'spotifyToken'\n}]))(AllSongs);","map":{"version":3,"sources":["/Users/zacharyresnick/Desktop/The_Democratic_Party/the_democratic_party/src/components/mainPages/AllSongs.js"],"names":["React","Component","SingleSong","connect","Spotify","grooverPlaylist","removeSong","firestoreConnect","compose","SpotifyWebApi","spotifyApi","AllSongs","constructor","getCurrentlyPlaying","bind","componentDidUpdate","props","tokens","token","setAccessToken","getMyCurrentPlayingTrack","err","data","currentSong","item","name","currentProgress","progress_ms","songLength","duration_ms","timeToEnd","setTimeout","songs","pageSongs","orderedSongs","sort","a","b","upvotes","topSong","console","log","title","artist","getPlaylist","snapshot","snapshot_id","tracks","items","currentPosition","findIndex","song","track","indicesToDestroy","length","i","push","removeTracksFromPlaylistInPositions","success","addTracksToPlaylist","uri","position","render","map","id","mapStateToProps","state","firestore","ordered","Songs","spotifyToken","mapDispatchToProps","dispatch","collection","orderBy"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport SingleSong from './SingleSong';\nimport { connect } from 'react-redux';\nimport Spotify from './Spotify';\nimport grooverPlaylist from './spotifyConfig';\nimport removeSong from '../../store/reducers/songReducer';\n\n//connect certain compomnents with the firestore using the firestoreConnect and compose at the bottom of this file:\nimport { firestoreConnect } from 'react-redux-firebase';\nimport { compose } from 'redux';\n\n//spotify web api\nimport SpotifyWebApi from 'spotify-web-api-js';\nvar spotifyApi = new SpotifyWebApi();\n\nexport class AllSongs extends Component {\n  constructor() {\n    super();\n    this.getCurrentlyPlaying.bind(this);\n  }\n\n  componentDidUpdate() {\n    if (this.props.tokens) {\n      let token = this.props.tokens[0].token;\n      spotifyApi.setAccessToken(token);\n      this.getCurrentlyPlaying(token);\n    }\n  }\n\n  //I cant get the information from get spotifyApi.getMyCurrentPlayingTrack to appear on state which made me have to go throught he madness below....\n\n  getCurrentlyPlaying(token) {\n    spotifyApi.getMyCurrentPlayingTrack(null, (err, data) => {\n      let currentSong = data && data.item.name;\n      let currentProgress = data && data.progress_ms;\n      let songLength = data && data.item.duration_ms;\n      let timeToEnd = songLength - currentProgress - 5000;\n      setTimeout(async () => {\n        let songs = this.props.songs;\n        let pageSongs = songs && [...songs];\n        let orderedSongs =\n          pageSongs &&\n          pageSongs.sort((a, b) => (a.upvotes > b.upvotes ? -1 : 1));\n        let topSong = orderedSongs[0];\n        console.log(\n          `ADDING ${topSong.title} by ${topSong.artist} TO THE GROOVER PLAYLIST`\n        );\n        await spotifyApi.getPlaylist(\n          grooverPlaylist,\n          null,\n          async (err, data) => {\n            const snapshot = data && data.snapshot_id;\n            let songs = data && data.tracks.items;\n            let currentPosition =\n              songs && songs.findIndex(song => song.track.name === currentSong);\n            let indicesToDestroy = [];\n            if (songs && songs.length) {\n              for (let i = currentPosition + 1; i < songs.length; i++) {\n                indicesToDestroy.push(i);\n              }\n            } else {\n              indicesToDestroy.push(1);\n            }\n            await spotifyApi.removeTracksFromPlaylistInPositions(\n              grooverPlaylist,\n              indicesToDestroy,\n              snapshot,\n              (err, success) => {\n                if (err) {\n                  console.log('err', err);\n                }\n              }\n            );\n            await spotifyApi.addTracksToPlaylist(\n              grooverPlaylist,\n              [topSong.uri],\n              { position: currentPosition + 1 },\n              (err, data) => {\n                if (err) {\n                  console.log('err', err);\n                }\n              }\n            );\n          }\n        );\n      }, timeToEnd);\n    });\n  }\n\n  render() {\n    let { songs, tokens } = this.props;\n    let pageSongs = songs && [...songs];\n    let token = tokens && tokens[0];\n    let orderedSongs =\n      pageSongs && pageSongs.sort((a, b) => (a.upvotes > b.upvotes ? -1 : 1));\n    return (\n      <div>\n        <div className=\"allSongs container\">\n          <h3 className=\"center\">All Songs</h3>\n          <table className=\"container songList\">\n            <tbody>\n              <tr>\n                <th className=\"tableHeaders\">Remove</th>\n                <th>Title</th>\n                <th>Artist</th>\n                <th>Album</th>\n                <th>Run Time</th>\n                <th>Votes</th>\n              </tr>\n              {songs &&\n                orderedSongs.map(song => {\n                  return <SingleSong key={song.id} {...song} />;\n                })}\n            </tbody>\n          </table>\n        </div>\n        <div className=\"player\">{token && <Spotify />}</div>\n      </div>\n    );\n  }\n}\n\n// mapState;\nconst mapStateToProps = state => {\n  return {\n    songs: state.firestore.ordered.Songs,\n    tokens: state.firestore.ordered.spotifyToken,\n  };\n};\n\nconst mapDispatchToProps = dispatch => ({\n  removeSong: id => {\n    dispatch(removeSong(id));\n  },\n});\n\n//use compose to connect connect and firestoreConnect together...\nexport default compose(\n  connect(\n    mapStateToProps,\n    mapDispatchToProps\n  ),\n  firestoreConnect([\n    { collection: 'Songs', orderBy: [['upvotes', 'desc']] },\n    { collection: 'spotifyToken' },\n  ])\n)(AllSongs);\n"]},"metadata":{},"sourceType":"module"}